{"componentChunkName":"component---src-pages-posts-wp-post-slug-tsx","path":"/posts/e7-be-8e-e5-9b-bdnsa-e7-bd-91-e7-bb-9c-e6-ad-a6-e5-99-a8-e9-a5-ae-e8-8c-b6-e5-88-86-e6-9e-90-e6-8a-a5-e5-91-8a/","result":{"data":{"wpPost":{"title":"美国NSA网络武器“饮茶”分析报告","excerpt":"<p>一、概述 国家计算机病毒应急处理中心在对西北工业大学遭境外网络攻击事件进行调查过程中，在西北工业大学的网络服务&hellip; <a class=\"more-link\" href=\"/%e7%be%8e%e5%9b%bdnsa%e7%bd%91%e7%bb%9c%e6%ad%a6%e5%99%a8%e9%a5%ae%e8%8c%b6%e5%88%86%e6%9e%90%e6%8a%a5%e5%91%8a/\">继续阅读<span class=\"screen-reader-text\">美国NSA网络武器“饮茶”分析报告</span></a></p>\n","content":"\n<h2>一、概述</h2>\n\n\n\n<p>国家计算机病毒应急处理中心在对西北工业大学遭境外网络攻击事件进行调查过程中，在西北工业大学的网络服务器设备上发现了美国国家安全局（NSA）专用的网络武器“饮茶”（NSA命名为“suctionchar”）（参见我中心2022年9月5日发布的《西北工业大学遭美国NSA网络攻击事件调查报告（之一）》）。国家计算机病毒应急处理中心联合北京奇安盘古实验室对该网络武器进行了技术分析，分析结果表明，该网络武器为“嗅探窃密类武器”，主要针对Unix/Linux平台，其主要功能是对目标主机上的远程访问账号密码进行窃取。</p>\n\n\n\n<h2>二、技术分析</h2>\n\n\n\n<p>经技术分析与研判，该网络武器针对Unix/Linux平台，与其他网络武器配合，攻击者可通过推送配置文件的方式控制该恶意软件执行特定窃密任务，该网络武器的主要目标是获取用户输入的各种用户名密码，包括SSH、TELNET、FTP和其他远程服务登录密码，也可根据配置窃取保存在其他位置的用户名密码信息。</p>\n\n\n\n<p>该网络武器包含“验证模块（authenticate）”、“解密模块（decrypt）”、“解码模块（decode）”、“配置模块”、“间谍模块（agent）”等多个组成部分，其主要工作流程和技术分析结果如下：</p>\n\n\n\n<h3>（一）验证模块</h3>\n\n\n\n<p>验证模块的主要功能是在“饮茶”被调用前验证其调用者（父进程）的身份，随后进行解密、解码以加载其他恶意软件模块。如图1所示。</p>\n\n\n\n<figure class=\"wp-block-image size-full\"><div data-gatsby-image-wrapper=\"\" style=\"position:relative;overflow:hidden;display:inline-block;vertical-align:top\" class=\"gatsby-image-wrapper gatsby-image-wrapper-constrained wp-image-165 inline-gatsby-image-wrapper\" data-reactroot=\"\"><div style=\"max-width:1596px;display:block\"><img alt=\"\" role=\"presentation\" aria-hidden=\"true\" src=\"data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;2514&#x27; width=&#x27;1596&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E\" style=\"max-width:100%;display:block;position:static\"/></div><div aria-hidden=\"true\" data-placeholder-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;width:100%\"></div><img data-gatsby-image-ssr=\"\" data-wp-inline-image=\"1\" data-main-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;transform:translateZ(0);transition:opacity 250ms linear;width:100%;will-change:opacity;opacity:0\" sizes=\"(min-width: 1596px) 1596px, 100vw\" decoding=\"async\" loading=\"lazy\" data-src=\"/_gatsby/image/f1ed20c9efeb837131ca628a30ca4b68/b825f61b4bde09ff11c72d8c1aa26bd5/068041-6yhjYM4C.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F068041-6yhjYM4C.png&amp;a=w%3D399%26h%3D629%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A26\" data-srcset=\"/_gatsby/image/f1ed20c9efeb837131ca628a30ca4b68/b825f61b4bde09ff11c72d8c1aa26bd5/068041-6yhjYM4C.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F068041-6yhjYM4C.png&amp;a=w%3D399%26h%3D629%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A26 399w,/_gatsby/image/f1ed20c9efeb837131ca628a30ca4b68/6f7d1471928d1ef8c05209bb83d62819/068041-6yhjYM4C.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F068041-6yhjYM4C.png&amp;a=w%3D798%26h%3D1257%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A26 798w,/_gatsby/image/f1ed20c9efeb837131ca628a30ca4b68/d8899cfcbe3837685662c7395f48af74/068041-6yhjYM4C.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F068041-6yhjYM4C.png&amp;a=w%3D1596%26h%3D2514%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A26 1596w\" alt=\"\"/><noscript><img data-gatsby-image-ssr=\"\" data-wp-inline-image=\"1\" data-main-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;transform:translateZ(0);transition:opacity 250ms linear;width:100%;will-change:opacity;opacity:0\" sizes=\"(min-width: 1596px) 1596px, 100vw\" decoding=\"async\" loading=\"lazy\" src=\"/_gatsby/image/f1ed20c9efeb837131ca628a30ca4b68/b825f61b4bde09ff11c72d8c1aa26bd5/068041-6yhjYM4C.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F068041-6yhjYM4C.png&amp;a=w%3D399%26h%3D629%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A26\" srcSet=\"/_gatsby/image/f1ed20c9efeb837131ca628a30ca4b68/b825f61b4bde09ff11c72d8c1aa26bd5/068041-6yhjYM4C.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F068041-6yhjYM4C.png&amp;a=w%3D399%26h%3D629%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A26 399w,/_gatsby/image/f1ed20c9efeb837131ca628a30ca4b68/6f7d1471928d1ef8c05209bb83d62819/068041-6yhjYM4C.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F068041-6yhjYM4C.png&amp;a=w%3D798%26h%3D1257%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A26 798w,/_gatsby/image/f1ed20c9efeb837131ca628a30ca4b68/d8899cfcbe3837685662c7395f48af74/068041-6yhjYM4C.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F068041-6yhjYM4C.png&amp;a=w%3D1596%26h%3D2514%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A26 1596w\" alt=\"\"/></noscript><script type=\"module\">const t=\"undefined\"!=typeof HTMLImageElement&&\"loading\"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll(\"img[data-main-image]\");for(let e of t){e.dataset.src&&(e.setAttribute(\"src\",e.dataset.src),e.removeAttribute(\"data-src\")),e.dataset.srcset&&(e.setAttribute(\"srcset\",e.dataset.srcset),e.removeAttribute(\"data-srcset\"));const t=e.parentNode.querySelectorAll(\"source[data-srcset]\");for(let e of t)e.setAttribute(\"srcset\",e.dataset.srcset),e.removeAttribute(\"data-srcset\");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector(\"[data-placeholder-image]\").style.opacity=0)}}</script></div><script type=\"application/json\" data-wp-inline-image-hydration=\"1\">{\"image\":{\"images\":{\"sources\":[],\"fallback\":{\"src\":\"/_gatsby/image/f1ed20c9efeb837131ca628a30ca4b68/b825f61b4bde09ff11c72d8c1aa26bd5/068041-6yhjYM4C.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F068041-6yhjYM4C.png&a=w%3D399%26h%3D629%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A05%3A26\",\"srcSet\":\"/_gatsby/image/f1ed20c9efeb837131ca628a30ca4b68/b825f61b4bde09ff11c72d8c1aa26bd5/068041-6yhjYM4C.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F068041-6yhjYM4C.png&a=w%3D399%26h%3D629%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A05%3A26 399w,/_gatsby/image/f1ed20c9efeb837131ca628a30ca4b68/6f7d1471928d1ef8c05209bb83d62819/068041-6yhjYM4C.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F068041-6yhjYM4C.png&a=w%3D798%26h%3D1257%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A05%3A26 798w,/_gatsby/image/f1ed20c9efeb837131ca628a30ca4b68/d8899cfcbe3837685662c7395f48af74/068041-6yhjYM4C.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F068041-6yhjYM4C.png&a=w%3D1596%26h%3D2514%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A05%3A26 1596w\",\"sizes\":\"(min-width: 1596px) 1596px, 100vw\"}},\"layout\":\"constrained\",\"width\":1596,\"height\":2514},\"alt\":\"\",\"className\":\"wp-image-165 inline-gatsby-image-wrapper\",\"data-wp-inline-image\":\"1\"}</script></figure>\n\n\n\n<h3>（二）解密模块</h3>\n\n\n\n<p>解密模块是通用模块，可被其他模块调用对指定文件进行解密，采用了与NOPEN远控木马（参见《“NOPEN”远控木马分析报告》）类似的RSA+RC6加密算法。如图2所示。</p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><div data-gatsby-image-wrapper=\"\" style=\"position:relative;overflow:hidden;display:inline-block;vertical-align:top\" class=\"gatsby-image-wrapper gatsby-image-wrapper-constrained wp-image-167 inline-gatsby-image-wrapper\" data-reactroot=\"\"><div style=\"max-width:1592px;display:block\"><img alt=\"\" role=\"presentation\" aria-hidden=\"true\" src=\"data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;3779&#x27; width=&#x27;1592&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E\" style=\"max-width:100%;display:block;position:static\"/></div><div aria-hidden=\"true\" data-placeholder-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;width:100%\"></div><img data-gatsby-image-ssr=\"\" data-wp-inline-image=\"2\" data-main-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;transform:translateZ(0);transition:opacity 250ms linear;width:100%;will-change:opacity;opacity:0\" sizes=\"(min-width: 1592px) 1592px, 100vw\" decoding=\"async\" loading=\"lazy\" data-src=\"/_gatsby/image/bfd70e05d99ef04709628f55eec7144e/fcd8b52b43f48f8415aea4247a6b5116/468662-b7mQrajE.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F468662-b7mQrajE.png&amp;a=w%3D398%26h%3D945%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A56\" data-srcset=\"/_gatsby/image/bfd70e05d99ef04709628f55eec7144e/fcd8b52b43f48f8415aea4247a6b5116/468662-b7mQrajE.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F468662-b7mQrajE.png&amp;a=w%3D398%26h%3D945%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A56 398w,/_gatsby/image/bfd70e05d99ef04709628f55eec7144e/12b07917c31438ff444f7b9c1a5530ab/468662-b7mQrajE.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F468662-b7mQrajE.png&amp;a=w%3D796%26h%3D1889%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A56 796w,/_gatsby/image/bfd70e05d99ef04709628f55eec7144e/89270bc6883ea7af0283dbd760f18e3e/468662-b7mQrajE.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F468662-b7mQrajE.png&amp;a=w%3D1592%26h%3D3779%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A56 1592w\" alt=\"\"/><noscript><img data-gatsby-image-ssr=\"\" data-wp-inline-image=\"2\" data-main-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;transform:translateZ(0);transition:opacity 250ms linear;width:100%;will-change:opacity;opacity:0\" sizes=\"(min-width: 1592px) 1592px, 100vw\" decoding=\"async\" loading=\"lazy\" src=\"/_gatsby/image/bfd70e05d99ef04709628f55eec7144e/fcd8b52b43f48f8415aea4247a6b5116/468662-b7mQrajE.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F468662-b7mQrajE.png&amp;a=w%3D398%26h%3D945%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A56\" srcSet=\"/_gatsby/image/bfd70e05d99ef04709628f55eec7144e/fcd8b52b43f48f8415aea4247a6b5116/468662-b7mQrajE.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F468662-b7mQrajE.png&amp;a=w%3D398%26h%3D945%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A56 398w,/_gatsby/image/bfd70e05d99ef04709628f55eec7144e/12b07917c31438ff444f7b9c1a5530ab/468662-b7mQrajE.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F468662-b7mQrajE.png&amp;a=w%3D796%26h%3D1889%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A56 796w,/_gatsby/image/bfd70e05d99ef04709628f55eec7144e/89270bc6883ea7af0283dbd760f18e3e/468662-b7mQrajE.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F468662-b7mQrajE.png&amp;a=w%3D1592%26h%3D3779%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A05%3A56 1592w\" alt=\"\"/></noscript><script type=\"module\">const t=\"undefined\"!=typeof HTMLImageElement&&\"loading\"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll(\"img[data-main-image]\");for(let e of t){e.dataset.src&&(e.setAttribute(\"src\",e.dataset.src),e.removeAttribute(\"data-src\")),e.dataset.srcset&&(e.setAttribute(\"srcset\",e.dataset.srcset),e.removeAttribute(\"data-srcset\"));const t=e.parentNode.querySelectorAll(\"source[data-srcset]\");for(let e of t)e.setAttribute(\"srcset\",e.dataset.srcset),e.removeAttribute(\"data-srcset\");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector(\"[data-placeholder-image]\").style.opacity=0)}}</script></div><script type=\"application/json\" data-wp-inline-image-hydration=\"2\">{\"image\":{\"images\":{\"sources\":[],\"fallback\":{\"src\":\"/_gatsby/image/bfd70e05d99ef04709628f55eec7144e/fcd8b52b43f48f8415aea4247a6b5116/468662-b7mQrajE.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F468662-b7mQrajE.png&a=w%3D398%26h%3D945%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A05%3A56\",\"srcSet\":\"/_gatsby/image/bfd70e05d99ef04709628f55eec7144e/fcd8b52b43f48f8415aea4247a6b5116/468662-b7mQrajE.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F468662-b7mQrajE.png&a=w%3D398%26h%3D945%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A05%3A56 398w,/_gatsby/image/bfd70e05d99ef04709628f55eec7144e/12b07917c31438ff444f7b9c1a5530ab/468662-b7mQrajE.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F468662-b7mQrajE.png&a=w%3D796%26h%3D1889%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A05%3A56 796w,/_gatsby/image/bfd70e05d99ef04709628f55eec7144e/89270bc6883ea7af0283dbd760f18e3e/468662-b7mQrajE.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F468662-b7mQrajE.png&a=w%3D1592%26h%3D3779%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A05%3A56 1592w\",\"sizes\":\"(min-width: 1592px) 1592px, 100vw\"}},\"layout\":\"constrained\",\"width\":1592,\"height\":3779},\"alt\":\"\",\"className\":\"wp-image-167 inline-gatsby-image-wrapper\",\"data-wp-inline-image\":\"2\"}</script></figure></div>\n\n\n<h3>（三）解码模块</h3>\n\n\n\n<p>与解密模块类似，解码模块也是通用模块，可以被其他模块调用对指定文件进行解码，但采用了自编码算法。如图3 所示。</p>\n\n\n\n<figure class=\"wp-block-image size-full\"><div data-gatsby-image-wrapper=\"\" style=\"position:relative;overflow:hidden;display:inline-block;vertical-align:top\" class=\"gatsby-image-wrapper gatsby-image-wrapper-constrained wp-image-169 inline-gatsby-image-wrapper\" data-reactroot=\"\"><div style=\"max-width:1592px;display:block\"><img alt=\"\" role=\"presentation\" aria-hidden=\"true\" src=\"data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;4215&#x27; width=&#x27;1592&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E\" style=\"max-width:100%;display:block;position:static\"/></div><div aria-hidden=\"true\" data-placeholder-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;width:100%\"></div><img data-gatsby-image-ssr=\"\" data-wp-inline-image=\"3\" data-main-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;transform:translateZ(0);transition:opacity 250ms linear;width:100%;will-change:opacity;opacity:0\" sizes=\"(min-width: 1592px) 1592px, 100vw\" decoding=\"async\" loading=\"lazy\" data-src=\"/_gatsby/image/0ab0884bdaea108de21a2df92bd2934b/3e31fcc08b1bbc27e5b40c1db7123d8c/689104-xjhgDgix.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F689104-xjhgDgix.png&amp;a=w%3D398%26h%3D1054%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A07%3A40\" data-srcset=\"/_gatsby/image/0ab0884bdaea108de21a2df92bd2934b/3e31fcc08b1bbc27e5b40c1db7123d8c/689104-xjhgDgix.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F689104-xjhgDgix.png&amp;a=w%3D398%26h%3D1054%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A07%3A40 398w,/_gatsby/image/0ab0884bdaea108de21a2df92bd2934b/eec76b6d21ea949933a4e9802c1a8484/689104-xjhgDgix.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F689104-xjhgDgix.png&amp;a=w%3D796%26h%3D2108%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A07%3A40 796w,/_gatsby/image/0ab0884bdaea108de21a2df92bd2934b/c9972a732505833dae57ee41691df2fc/689104-xjhgDgix.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F689104-xjhgDgix.png&amp;a=w%3D1592%26h%3D4215%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A07%3A40 1592w\" alt=\"\"/><noscript><img data-gatsby-image-ssr=\"\" data-wp-inline-image=\"3\" data-main-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;transform:translateZ(0);transition:opacity 250ms linear;width:100%;will-change:opacity;opacity:0\" sizes=\"(min-width: 1592px) 1592px, 100vw\" decoding=\"async\" loading=\"lazy\" src=\"/_gatsby/image/0ab0884bdaea108de21a2df92bd2934b/3e31fcc08b1bbc27e5b40c1db7123d8c/689104-xjhgDgix.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F689104-xjhgDgix.png&amp;a=w%3D398%26h%3D1054%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A07%3A40\" srcSet=\"/_gatsby/image/0ab0884bdaea108de21a2df92bd2934b/3e31fcc08b1bbc27e5b40c1db7123d8c/689104-xjhgDgix.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F689104-xjhgDgix.png&amp;a=w%3D398%26h%3D1054%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A07%3A40 398w,/_gatsby/image/0ab0884bdaea108de21a2df92bd2934b/eec76b6d21ea949933a4e9802c1a8484/689104-xjhgDgix.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F689104-xjhgDgix.png&amp;a=w%3D796%26h%3D2108%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A07%3A40 796w,/_gatsby/image/0ab0884bdaea108de21a2df92bd2934b/c9972a732505833dae57ee41691df2fc/689104-xjhgDgix.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F689104-xjhgDgix.png&amp;a=w%3D1592%26h%3D4215%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A07%3A40 1592w\" alt=\"\"/></noscript><script type=\"module\">const t=\"undefined\"!=typeof HTMLImageElement&&\"loading\"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll(\"img[data-main-image]\");for(let e of t){e.dataset.src&&(e.setAttribute(\"src\",e.dataset.src),e.removeAttribute(\"data-src\")),e.dataset.srcset&&(e.setAttribute(\"srcset\",e.dataset.srcset),e.removeAttribute(\"data-srcset\"));const t=e.parentNode.querySelectorAll(\"source[data-srcset]\");for(let e of t)e.setAttribute(\"srcset\",e.dataset.srcset),e.removeAttribute(\"data-srcset\");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector(\"[data-placeholder-image]\").style.opacity=0)}}</script></div><script type=\"application/json\" data-wp-inline-image-hydration=\"3\">{\"image\":{\"images\":{\"sources\":[],\"fallback\":{\"src\":\"/_gatsby/image/0ab0884bdaea108de21a2df92bd2934b/3e31fcc08b1bbc27e5b40c1db7123d8c/689104-xjhgDgix.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F689104-xjhgDgix.png&a=w%3D398%26h%3D1054%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A07%3A40\",\"srcSet\":\"/_gatsby/image/0ab0884bdaea108de21a2df92bd2934b/3e31fcc08b1bbc27e5b40c1db7123d8c/689104-xjhgDgix.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F689104-xjhgDgix.png&a=w%3D398%26h%3D1054%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A07%3A40 398w,/_gatsby/image/0ab0884bdaea108de21a2df92bd2934b/eec76b6d21ea949933a4e9802c1a8484/689104-xjhgDgix.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F689104-xjhgDgix.png&a=w%3D796%26h%3D2108%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A07%3A40 796w,/_gatsby/image/0ab0884bdaea108de21a2df92bd2934b/c9972a732505833dae57ee41691df2fc/689104-xjhgDgix.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F689104-xjhgDgix.png&a=w%3D1592%26h%3D4215%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A07%3A40 1592w\",\"sizes\":\"(min-width: 1592px) 1592px, 100vw\"}},\"layout\":\"constrained\",\"width\":1592,\"height\":4215},\"alt\":\"\",\"className\":\"wp-image-169 inline-gatsby-image-wrapper\",\"data-wp-inline-image\":\"3\"}</script></figure>\n\n\n\n<h3>（四）配置模块</h3>\n\n\n\n<p>配置模块的主要功能是读取攻击者远程投送的xml格式配置文件中的指令和匹配规则，并生成二进制配置文件，从而由“监视模块”和“间谍模块”调用后在受害主机上查找相关内容。如图4、图5所示。</p>\n\n\n\n<figure class=\"wp-block-image size-full\"><div data-gatsby-image-wrapper=\"\" style=\"position:relative;overflow:hidden;display:inline-block;vertical-align:top\" class=\"gatsby-image-wrapper gatsby-image-wrapper-constrained wp-image-171 inline-gatsby-image-wrapper\" data-reactroot=\"\"><div style=\"max-width:1598px;display:block\"><img alt=\"\" role=\"presentation\" aria-hidden=\"true\" src=\"data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;938&#x27; width=&#x27;1598&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E\" style=\"max-width:100%;display:block;position:static\"/></div><div aria-hidden=\"true\" data-placeholder-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;width:100%\"></div><img data-gatsby-image-ssr=\"\" data-wp-inline-image=\"4\" data-main-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;transform:translateZ(0);transition:opacity 250ms linear;width:100%;will-change:opacity;opacity:0\" sizes=\"(min-width: 1598px) 1598px, 100vw\" decoding=\"async\" loading=\"lazy\" data-src=\"/_gatsby/image/cd82c31586d724c0df99cb8819f78343/527b8182e12ecf3150c7391d63ccc8f1/890341-iZ6J7goh.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F890341-iZ6J7goh.png&amp;a=w%3D400%26h%3D235%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A08%3A17\" data-srcset=\"/_gatsby/image/cd82c31586d724c0df99cb8819f78343/527b8182e12ecf3150c7391d63ccc8f1/890341-iZ6J7goh.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F890341-iZ6J7goh.png&amp;a=w%3D400%26h%3D235%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A08%3A17 400w,/_gatsby/image/cd82c31586d724c0df99cb8819f78343/60b82c657092a6cefbd27d5e6e628572/890341-iZ6J7goh.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F890341-iZ6J7goh.png&amp;a=w%3D799%26h%3D469%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A08%3A17 799w,/_gatsby/image/cd82c31586d724c0df99cb8819f78343/072fd1503ade1f68fbedb533075dbfe8/890341-iZ6J7goh.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F890341-iZ6J7goh.png&amp;a=w%3D1598%26h%3D938%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A08%3A17 1598w\" alt=\"\"/><noscript><img data-gatsby-image-ssr=\"\" data-wp-inline-image=\"4\" data-main-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;transform:translateZ(0);transition:opacity 250ms linear;width:100%;will-change:opacity;opacity:0\" sizes=\"(min-width: 1598px) 1598px, 100vw\" decoding=\"async\" loading=\"lazy\" src=\"/_gatsby/image/cd82c31586d724c0df99cb8819f78343/527b8182e12ecf3150c7391d63ccc8f1/890341-iZ6J7goh.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F890341-iZ6J7goh.png&amp;a=w%3D400%26h%3D235%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A08%3A17\" srcSet=\"/_gatsby/image/cd82c31586d724c0df99cb8819f78343/527b8182e12ecf3150c7391d63ccc8f1/890341-iZ6J7goh.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F890341-iZ6J7goh.png&amp;a=w%3D400%26h%3D235%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A08%3A17 400w,/_gatsby/image/cd82c31586d724c0df99cb8819f78343/60b82c657092a6cefbd27d5e6e628572/890341-iZ6J7goh.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F890341-iZ6J7goh.png&amp;a=w%3D799%26h%3D469%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A08%3A17 799w,/_gatsby/image/cd82c31586d724c0df99cb8819f78343/072fd1503ade1f68fbedb533075dbfe8/890341-iZ6J7goh.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F890341-iZ6J7goh.png&amp;a=w%3D1598%26h%3D938%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A08%3A17 1598w\" alt=\"\"/></noscript><script type=\"module\">const t=\"undefined\"!=typeof HTMLImageElement&&\"loading\"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll(\"img[data-main-image]\");for(let e of t){e.dataset.src&&(e.setAttribute(\"src\",e.dataset.src),e.removeAttribute(\"data-src\")),e.dataset.srcset&&(e.setAttribute(\"srcset\",e.dataset.srcset),e.removeAttribute(\"data-srcset\"));const t=e.parentNode.querySelectorAll(\"source[data-srcset]\");for(let e of t)e.setAttribute(\"srcset\",e.dataset.srcset),e.removeAttribute(\"data-srcset\");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector(\"[data-placeholder-image]\").style.opacity=0)}}</script></div><script type=\"application/json\" data-wp-inline-image-hydration=\"4\">{\"image\":{\"images\":{\"sources\":[],\"fallback\":{\"src\":\"/_gatsby/image/cd82c31586d724c0df99cb8819f78343/527b8182e12ecf3150c7391d63ccc8f1/890341-iZ6J7goh.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F890341-iZ6J7goh.png&a=w%3D400%26h%3D235%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A08%3A17\",\"srcSet\":\"/_gatsby/image/cd82c31586d724c0df99cb8819f78343/527b8182e12ecf3150c7391d63ccc8f1/890341-iZ6J7goh.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F890341-iZ6J7goh.png&a=w%3D400%26h%3D235%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A08%3A17 400w,/_gatsby/image/cd82c31586d724c0df99cb8819f78343/60b82c657092a6cefbd27d5e6e628572/890341-iZ6J7goh.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F890341-iZ6J7goh.png&a=w%3D799%26h%3D469%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A08%3A17 799w,/_gatsby/image/cd82c31586d724c0df99cb8819f78343/072fd1503ade1f68fbedb533075dbfe8/890341-iZ6J7goh.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F890341-iZ6J7goh.png&a=w%3D1598%26h%3D938%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A08%3A17 1598w\",\"sizes\":\"(min-width: 1598px) 1598px, 100vw\"}},\"layout\":\"constrained\",\"width\":1598,\"height\":938},\"alt\":\"\",\"className\":\"wp-image-171 inline-gatsby-image-wrapper\",\"data-wp-inline-image\":\"4\"}</script></figure>\n\n\n\n<figure class=\"wp-block-image size-full\"><div data-gatsby-image-wrapper=\"\" style=\"position:relative;overflow:hidden;display:inline-block;vertical-align:top\" class=\"gatsby-image-wrapper gatsby-image-wrapper-constrained wp-image-173 inline-gatsby-image-wrapper\" data-reactroot=\"\"><div style=\"max-width:1592px;display:block\"><img alt=\"\" role=\"presentation\" aria-hidden=\"true\" src=\"data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;4802&#x27; width=&#x27;1592&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E\" style=\"max-width:100%;display:block;position:static\"/></div><div aria-hidden=\"true\" data-placeholder-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;width:100%\"></div><img data-gatsby-image-ssr=\"\" data-wp-inline-image=\"5\" data-main-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;transform:translateZ(0);transition:opacity 250ms linear;width:100%;will-change:opacity;opacity:0\" sizes=\"(min-width: 1592px) 1592px, 100vw\" decoding=\"async\" loading=\"lazy\" data-src=\"/_gatsby/image/e6f78973a7803c4f42eb5590a43b8f6b/8bbeb0e1ce770accd9303451d96a6e58/094472-X7Go5XTl.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F094472-X7Go5XTl.png&amp;a=w%3D398%26h%3D1201%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A18\" data-srcset=\"/_gatsby/image/e6f78973a7803c4f42eb5590a43b8f6b/8bbeb0e1ce770accd9303451d96a6e58/094472-X7Go5XTl.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F094472-X7Go5XTl.png&amp;a=w%3D398%26h%3D1201%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A18 398w,/_gatsby/image/e6f78973a7803c4f42eb5590a43b8f6b/71aa824a735d204a32c7f8aeea02f86c/094472-X7Go5XTl.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F094472-X7Go5XTl.png&amp;a=w%3D796%26h%3D2401%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A18 796w,/_gatsby/image/e6f78973a7803c4f42eb5590a43b8f6b/318c6d74e39e426605df6c4d3054ac3a/094472-X7Go5XTl.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F094472-X7Go5XTl.png&amp;a=w%3D1592%26h%3D4802%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A18 1592w\" alt=\"\"/><noscript><img data-gatsby-image-ssr=\"\" data-wp-inline-image=\"5\" data-main-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;transform:translateZ(0);transition:opacity 250ms linear;width:100%;will-change:opacity;opacity:0\" sizes=\"(min-width: 1592px) 1592px, 100vw\" decoding=\"async\" loading=\"lazy\" src=\"/_gatsby/image/e6f78973a7803c4f42eb5590a43b8f6b/8bbeb0e1ce770accd9303451d96a6e58/094472-X7Go5XTl.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F094472-X7Go5XTl.png&amp;a=w%3D398%26h%3D1201%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A18\" srcSet=\"/_gatsby/image/e6f78973a7803c4f42eb5590a43b8f6b/8bbeb0e1ce770accd9303451d96a6e58/094472-X7Go5XTl.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F094472-X7Go5XTl.png&amp;a=w%3D398%26h%3D1201%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A18 398w,/_gatsby/image/e6f78973a7803c4f42eb5590a43b8f6b/71aa824a735d204a32c7f8aeea02f86c/094472-X7Go5XTl.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F094472-X7Go5XTl.png&amp;a=w%3D796%26h%3D2401%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A18 796w,/_gatsby/image/e6f78973a7803c4f42eb5590a43b8f6b/318c6d74e39e426605df6c4d3054ac3a/094472-X7Go5XTl.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F094472-X7Go5XTl.png&amp;a=w%3D1592%26h%3D4802%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A18 1592w\" alt=\"\"/></noscript><script type=\"module\">const t=\"undefined\"!=typeof HTMLImageElement&&\"loading\"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll(\"img[data-main-image]\");for(let e of t){e.dataset.src&&(e.setAttribute(\"src\",e.dataset.src),e.removeAttribute(\"data-src\")),e.dataset.srcset&&(e.setAttribute(\"srcset\",e.dataset.srcset),e.removeAttribute(\"data-srcset\"));const t=e.parentNode.querySelectorAll(\"source[data-srcset]\");for(let e of t)e.setAttribute(\"srcset\",e.dataset.srcset),e.removeAttribute(\"data-srcset\");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector(\"[data-placeholder-image]\").style.opacity=0)}}</script></div><script type=\"application/json\" data-wp-inline-image-hydration=\"5\">{\"image\":{\"images\":{\"sources\":[],\"fallback\":{\"src\":\"/_gatsby/image/e6f78973a7803c4f42eb5590a43b8f6b/8bbeb0e1ce770accd9303451d96a6e58/094472-X7Go5XTl.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F094472-X7Go5XTl.png&a=w%3D398%26h%3D1201%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A10%3A18\",\"srcSet\":\"/_gatsby/image/e6f78973a7803c4f42eb5590a43b8f6b/8bbeb0e1ce770accd9303451d96a6e58/094472-X7Go5XTl.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F094472-X7Go5XTl.png&a=w%3D398%26h%3D1201%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A10%3A18 398w,/_gatsby/image/e6f78973a7803c4f42eb5590a43b8f6b/71aa824a735d204a32c7f8aeea02f86c/094472-X7Go5XTl.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F094472-X7Go5XTl.png&a=w%3D796%26h%3D2401%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A10%3A18 796w,/_gatsby/image/e6f78973a7803c4f42eb5590a43b8f6b/318c6d74e39e426605df6c4d3054ac3a/094472-X7Go5XTl.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F094472-X7Go5XTl.png&a=w%3D1592%26h%3D4802%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A10%3A18 1592w\",\"sizes\":\"(min-width: 1592px) 1592px, 100vw\"}},\"layout\":\"constrained\",\"width\":1592,\"height\":4802},\"alt\":\"\",\"className\":\"wp-image-173 inline-gatsby-image-wrapper\",\"data-wp-inline-image\":\"5\"}</script></figure>\n\n\n\n<h3>（五）间谍模块</h3>\n\n\n\n<p>间谍模块的主要功能是按照攻击者下发的指令和规则从受害主机上提取相应的敏感信息并输出到指定位置。</p>\n\n\n\n<figure class=\"wp-block-image size-full\"><div data-gatsby-image-wrapper=\"\" style=\"position:relative;overflow:hidden;display:inline-block;vertical-align:top\" class=\"gatsby-image-wrapper gatsby-image-wrapper-constrained wp-image-175 inline-gatsby-image-wrapper\" data-reactroot=\"\"><div style=\"max-width:1596px;display:block\"><img alt=\"\" role=\"presentation\" aria-hidden=\"true\" src=\"data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;1869&#x27; width=&#x27;1596&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E\" style=\"max-width:100%;display:block;position:static\"/></div><div aria-hidden=\"true\" data-placeholder-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;width:100%\"></div><img data-gatsby-image-ssr=\"\" data-wp-inline-image=\"6\" data-main-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;transform:translateZ(0);transition:opacity 250ms linear;width:100%;will-change:opacity;opacity:0\" sizes=\"(min-width: 1596px) 1596px, 100vw\" decoding=\"async\" loading=\"lazy\" data-src=\"/_gatsby/image/14627d3d324c8f15f2057d07ee6bea0f/6d4dcaef9b3ff345bbd99d1e85ffe4b4/439931-Yx1eytUU.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F439931-Yx1eytUU.png&amp;a=w%3D399%26h%3D467%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A37\" data-srcset=\"/_gatsby/image/14627d3d324c8f15f2057d07ee6bea0f/6d4dcaef9b3ff345bbd99d1e85ffe4b4/439931-Yx1eytUU.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F439931-Yx1eytUU.png&amp;a=w%3D399%26h%3D467%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A37 399w,/_gatsby/image/14627d3d324c8f15f2057d07ee6bea0f/80ddfba5fbe9de437bed048ba0a14649/439931-Yx1eytUU.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F439931-Yx1eytUU.png&amp;a=w%3D798%26h%3D935%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A37 798w,/_gatsby/image/14627d3d324c8f15f2057d07ee6bea0f/5d701ba7d2553a44687b6808579b2a4e/439931-Yx1eytUU.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F439931-Yx1eytUU.png&amp;a=w%3D1596%26h%3D1869%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A37 1596w\" alt=\"\"/><noscript><img data-gatsby-image-ssr=\"\" data-wp-inline-image=\"6\" data-main-image=\"\" style=\"height:100%;left:0;position:absolute;top:0;transform:translateZ(0);transition:opacity 250ms linear;width:100%;will-change:opacity;opacity:0\" sizes=\"(min-width: 1596px) 1596px, 100vw\" decoding=\"async\" loading=\"lazy\" src=\"/_gatsby/image/14627d3d324c8f15f2057d07ee6bea0f/6d4dcaef9b3ff345bbd99d1e85ffe4b4/439931-Yx1eytUU.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F439931-Yx1eytUU.png&amp;a=w%3D399%26h%3D467%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A37\" srcSet=\"/_gatsby/image/14627d3d324c8f15f2057d07ee6bea0f/6d4dcaef9b3ff345bbd99d1e85ffe4b4/439931-Yx1eytUU.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F439931-Yx1eytUU.png&amp;a=w%3D399%26h%3D467%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A37 399w,/_gatsby/image/14627d3d324c8f15f2057d07ee6bea0f/80ddfba5fbe9de437bed048ba0a14649/439931-Yx1eytUU.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F439931-Yx1eytUU.png&amp;a=w%3D798%26h%3D935%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A37 798w,/_gatsby/image/14627d3d324c8f15f2057d07ee6bea0f/5d701ba7d2553a44687b6808579b2a4e/439931-Yx1eytUU.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F439931-Yx1eytUU.png&amp;a=w%3D1596%26h%3D1869%26fm%3Dpng%26q%3D90&amp;cd=2022-12-02T01%3A10%3A37 1596w\" alt=\"\"/></noscript><script type=\"module\">const t=\"undefined\"!=typeof HTMLImageElement&&\"loading\"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll(\"img[data-main-image]\");for(let e of t){e.dataset.src&&(e.setAttribute(\"src\",e.dataset.src),e.removeAttribute(\"data-src\")),e.dataset.srcset&&(e.setAttribute(\"srcset\",e.dataset.srcset),e.removeAttribute(\"data-srcset\"));const t=e.parentNode.querySelectorAll(\"source[data-srcset]\");for(let e of t)e.setAttribute(\"srcset\",e.dataset.srcset),e.removeAttribute(\"data-srcset\");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector(\"[data-placeholder-image]\").style.opacity=0)}}</script></div><script type=\"application/json\" data-wp-inline-image-hydration=\"6\">{\"image\":{\"images\":{\"sources\":[],\"fallback\":{\"src\":\"/_gatsby/image/14627d3d324c8f15f2057d07ee6bea0f/6d4dcaef9b3ff345bbd99d1e85ffe4b4/439931-Yx1eytUU.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F439931-Yx1eytUU.png&a=w%3D399%26h%3D467%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A10%3A37\",\"srcSet\":\"/_gatsby/image/14627d3d324c8f15f2057d07ee6bea0f/6d4dcaef9b3ff345bbd99d1e85ffe4b4/439931-Yx1eytUU.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F439931-Yx1eytUU.png&a=w%3D399%26h%3D467%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A10%3A37 399w,/_gatsby/image/14627d3d324c8f15f2057d07ee6bea0f/80ddfba5fbe9de437bed048ba0a14649/439931-Yx1eytUU.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F439931-Yx1eytUU.png&a=w%3D798%26h%3D935%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A10%3A37 798w,/_gatsby/image/14627d3d324c8f15f2057d07ee6bea0f/5d701ba7d2553a44687b6808579b2a4e/439931-Yx1eytUU.png?u=http%3A%2F%2F13.208.130.157%2Fwp-content%2Fuploads%2F2022%2F12%2F439931-Yx1eytUU.png&a=w%3D1596%26h%3D1869%26fm%3Dpng%26q%3D90&cd=2022-12-02T01%3A10%3A37 1596w\",\"sizes\":\"(min-width: 1596px) 1596px, 100vw\"}},\"layout\":\"constrained\",\"width\":1596,\"height\":1869},\"alt\":\"\",\"className\":\"wp-image-175 inline-gatsby-image-wrapper\",\"data-wp-inline-image\":\"6\"}</script></figure>\n\n\n\n<h3>（六）其他模块</h3>\n\n\n\n<p>在分析过程中，我们还发现另外两个模块，分别是配置文件生成模块和守护者模块。其中，配置文件生成模块的功能可能是生成ini临时配置文件，而守护者模块与间谍模块具有很高的代码相似性，可能是为不同版本系统生产的变种。</p>\n\n\n\n<h2>三、总结</h2>\n\n\n\n<p>基于上述分析结果，技术分析团队认为，“饮茶”编码复杂，高度模块化，支持多线程，适配操作系统环境广泛，包括FreeBSD、Sun Solaris系统以及Debian、RedHat、Centos、Ubuntu等多种Linux发行版，反映出开发者先进的软件工程化能力。“饮茶”还具有较好的开放性，可以与其他网络武器有效进行集成和联动，其采用加密和校验等方式加强了自身安全性和隐蔽性，并且其通过灵活的配置功能，不仅可以提取登录用户名密码等信息，理论上也可以提取所有攻击者想获取的信息，是功能先进，隐蔽性强的强大网络武器工具。</p>\n\n\n\n<p>在此次针对西北工业大学的攻击中，美国NSA下属特定入侵行动办公室（TAO）使用“饮茶”作为嗅探窃密工具，将其植入西北工业大学内部网络服务器，窃取了SSH、TELNET、FTP、SCP等远程管理和远程文件传输服务的登录密码，从而获得内网中其他服务器的访问权限，实现内网横向移动，并向其他高价值服务器投送其他嗅探窃密类、持久化控制类和隐蔽消痕类网络武器，造成大规模、持续性敏感数据失窃。随着调查的逐步深入，技术团队还在西北工业大学之外的其他机构网络中发现了“饮茶”的攻击痕迹，很可能是TAO利用“饮茶”对中国发动了大规模的网络攻击活动。</p>\n","dateGmt":"2022-12-02T04:13:07+00:00","categories":{"nodes":[{"id":"dGVybTozNTE=","name":"专题报告","slugPath":"/special-report/"},{"id":"dGVybTo5Mw==","name":"事件分析","slugPath":"/analysis-reports/"}]},"featuredImage":{"node":{"localFile":{"publicURL":"/static/def9e944199c691ad9cf2ef6e09bffb6/919501-65tA3ooZ.jpg"}}}}},"pageContext":{"id":"cG9zdDoxNTM=","slug":"%e7%be%8e%e5%9b%bdnsa%e7%bd%91%e7%bb%9c%e6%ad%a6%e5%99%a8%e9%a5%ae%e8%8c%b6%e5%88%86%e6%9e%90%e6%8a%a5%e5%91%8a","__params":{"slug":"e7-be-8e-e5-9b-bdnsa-e7-bd-91-e7-bb-9c-e6-ad-a6-e5-99-a8-e9-a5-ae-e8-8c-b6-e5-88-86-e6-9e-90-e6-8a-a5-e5-91-8a"}}},"staticQueryHashes":["1261413882","1630072065","2392334409","3381727315","3680385952"]}